######################################################
##
## Component public variables
##
## Variables accesible to the experimenter.
##
## They are contained inside 4 global variables
## with all required info:
##
##   1. metadata: General information like mantainers,
##      component dependencies and allowed platforms
##
##   2. input: Customizable variables for each
##      deployment to be filled by the experimenter
##      or the TNLCM
##
##   3. output: Values sent to the TNLCM callback to
##      keep track of the TN deployments
##
######################################################

####################################
## Component metadata
####################################
metadata:
  maintainers:
    - Rafael Manuel García Arévalo <rafagarciaa31@uma.es> 
  short_description: TODO
  long_description: |
    TODO
  hypervisors: [one]

####################################
## Component input
####################################
input:
  input:
  one_int_p4_sw_cpu:
    description: Number of CPUs for all VMs (switches and collector)
    type: int
    default_value: 2
    required_when: false

  one_int_p4_sw_memory:
    description: Memory in MB for all VMs (switches and collector)
    type: int
    default_value: 4096
    required_when: false

  one_int_p4_sw_disk:
    description: Disk size in MB for all VMs (switches and collector)
    type: int
    default_value: 25600
    required_when: false

  one_int_p4_sw_switches:
    description: |
      Configuration for INT-P4 switches. Dictionary with the following structure per switch:
      - type: Type of switch (source, transit, sink)
      - networks: List of networks to connect
      - config: Switch specific configuration including:
        - switch_id: Unique identifier
        - interfaces: List of network interfaces
        - int_config: INT specific configuration
    type: dict
    default_value: {
      "int_p4_switch_0": {
        "type": "source",
        "networks": ["tn_vxlan", "vnet-vnet_1"],
        "config": {
          "switch_id": 1,
          "interfaces": [
            {"name": "eth1", "id": 1},
            {"name": "eth2", "id": 2}
          ],
          "int_config": {
            "forward_rules": [
              {"dst_addr": "00:aa:bb:00:00:14", "port": 1, "priority": 1},
              {"dst_addr": "00:aa:bb:00:00:16", "port": 2, "priority": 1}
            ],
            "ingress_port": 1,
            "egress_port": 2,
            "hop_metadata_len": 5,
            "max_hop": 4,
            "ins_mask": "0xEC00"
          }
        }
      }
    }
    required_when: true

  one_int_p4_sw_collector:
    description: |
      Configuration for INT-P4 collector. Dictionary with:
      - networks: List of networks to connect
      - config: Collector specific configuration
    type: dict
    default_value: {
      "networks": ["tn_vxlan", "vnet-vnet_1"],
      "config": {}
    }
    required_when: true

####################################
## Component output
####################################
output:
  id: ID of the deployment
  ips: List of all IPs
  switch_ips: Dictionary of switch IPs per network
  collector_ip: IP of the INT collector
